<!DOCTYPE html>
<html>
<head>
<title>Paw Safari Extension</title>
<script type="text/javascript">
function handleCommand(event) {
	if (event.command === "openlinkinpaw" || event.command === "openpageinpaw") {
		var url = "";
		if (event.command === "openlinkinpaw") {
			url = event.userInfo['href'];
		}
		else if (event.command === "openpageinpaw") {
			url = safari.application.activeBrowserWindow.activeTab.url;
		}
		console.log(url);
		safari.application.activeBrowserWindow.activeTab.url = "paw://?url="+url;
	}
}

function handleContextMenuExtensionEvent(event) {
	if (event.userInfo['nodeName'] === "A") {
		event.contextMenu.appendContextMenuItem("openlinkinpaw", "Open Link in Paw");
	}
}

safari.application.addEventListener("contextmenu", handleContextMenuExtensionEvent, false);
safari.application.addEventListener("command", handleCommand, false);
</script>
</head>
<body>
	
</body>
</html>
